var http =require ('http'),
inspect = require('util').inspect;
var fs = require ('fs');
var busboy = require('busboy');

http.createServer( function ( req, res) {
if (req.method =='post') {
var busboy = 'new' Busboy ( { header : req.headers});
busboy.on ('file'), function( fieldname , file , filename , encoding , mimetype){
var fstream= fs. createWrite stream('./public/' + filename);
file.pipe (fstream)
console.log ('file[' + fieldname +'] : ' + filename + ' , encoding:' , + 'encoding , ' + mimety
file.on (' File [' + fieldname + '] got' + data.length + ' bytes');
});
file.on ('data', function (data) {
console.log(' file [' + fieldname + ' ) ] got' + data.length +' bytes);
});
file.on ('end' , function() {
console.log ('File [ ' + fieldname + ' ] finished' ];
});
});
busboy.on (' finish' , function() {
console.log ('done parsing form!');
res.writeHead (303 , { connection: 'close' , Location: '/'});
res.send();
});
req.pipe (busboy);
} elseif (req.method = = GET ){
res.writeHead(200 , { connection : 'close' } );
res.end ('<html><head></head><body>'\
<form method ="post" enctype = "multipart / form-data>"
<input type = "text" name = "txtfield"> <br/>\
<input type = "file" name = "file field"> <br/>\
<input type = "submit">\
</form>\
</body></html>);
}
